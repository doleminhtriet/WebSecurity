from typing import Dict, List, Optional, Union
from pydantic import BaseModel, Field

FeatureValue = Union[str, float, int, bool, None]

# Response model for malware scan results
class MalwareScanOut(BaseModel):
    label: int = Field(..., description="1=malicious, 0=benign")
    probability: float = Field(..., ge=0.0, le=1.0)
    threshold: float = Field(..., ge=0.0, le=1.0)
    sha256: str
    size: int = Field(..., ge=0)
    indicators: List[str]
    features: Dict[str, FeatureValue]
    filename: Optional[str] = None
    content_type: Optional[str] = None

# Response model for health check of the malware scanner
class MalwareHealthOut(BaseModel):
    scanner_initialized: bool
    engine: str
    threshold: float
    max_bytes: Optional[int] = None
    mongodb_enabled: bool
    mongodb_connected: bool
    collection: Optional[str] = None

# Response model for reloading the malware scanner configuration
class MalwareReloadOut(BaseModel):
    ok: bool
    engine: str
    threshold: float
    scanner_config: Dict[str, Optional[str]]
